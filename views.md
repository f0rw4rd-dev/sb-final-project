# Основные представления

## Функциональное

1. API Gateway / BFF.
   * Точка входа для мобильного приложения и веб-сайта.
   * Аутентификация, авторизация (через IDP), маршрутизация запросов к нужным сервисам внутри Service Mesh.
2. Service Mesh.
   * Сетевой слой взаимодействия микросервисов, обеспечивающий балансировку, безопасность (mTLS), мониторинг запросов.
3. Сервисы.
   * Сервис социальной платформы: группы, лента активности, взаимодействие между пользователями, комментарии.
   * Сервис тренировок: журнал тренировок, планировщик, хранение результатов.
   * Сервис аналитики: сбор агрегированных статистик, вычисление ключевых метрик для пользователей и общей системы.
   * Сервис рекомендаций: персональные предложения (товары, планы тренировок), алгоритмы геймификации, ML-логика.
   * Сервис фитнес-устройств: интеграция с внешними носимыми гаджетами, трекерами, получение данных о тренировках.
   * Сервис промоакций: управление акциями, скидками, их условиями и периодами действия.
   * Сервис интеграции с магазином: связь с e-commerce платформой компании (каталог товаров).
   * Сервис уведомлений: отправка push, email, SMS при событиях (новый пост, достижение, персональная акция).

## Информационное
1. Кластер операционных БД.
   * Содержит базы для операционных данных:
     * БД фитнес-устройств: данные о фитнес-устройствах, подключенных аккаунтах пользователей.
     * БД тренировок: сведения о тренировках, расписаниях.
     * БД промоакций: таблицы с акциями, скидками, условиями.
     * БД пользователей и групп: пользователи, группы, посты в лентах, комментарии.
2. Кластер аналитических БД.
   * БД аналитики: агрегированные и исторические данные, применяемые для отчетов, статистики, а также для обучения ML-моделей.
3. Message Broker (Kafka).
   * Асинхронные события (новая тренировка, новый пост, достижения пользователя), которые обрабатываются подписчиками.
4. Object Storage (S3).
   * Хранение файлов и медиа (фото профиля, изображения, видео и т. п.).
   * Сервисы могут загружать/читать файлы.

## Многозадачность
1. Горизонтальное масштабирование.
   * В Kubernetes-кластере каждая служба может работать в нескольких экземплярах, распределяя нагрузку.
   * API Gateway также масштабируется, чтобы обрабатывать растущий поток запросов от пользователей.
2. Асинхронная обработка событий.
   * Использование Kafka (или другого брокера) для отправки/получения событий.
3. Согласованность данных.
   * Синхронные операции CRUD (через API Gateway к операционным базам) осуществляют непосредственное изменение данных (ACID-транзакции в пределах одной службы/БД).
   * Межсервисная согласованность достигается через события (eventual consistency). Если необходимо поддерживать строгую транзакционность, используется паттерн "Saga".
4. Параллельная работа.
   * Одновременные запросы от пользователей, интеграции с устройствами, обновления промоакций - все это обрабатывается параллельно, распределяясь по микросервисам.

## Инфраструктурное
1. Kubernetes кластер.
   * Каждый сервис развертывается как Deployment (с набором pod'ов), управляемый Kubernetes.
   * Service Mesh развернут поверх кластера, обеспечивая политику сетевых взаимодействий.
   * API Gateway (BFF) как отдельный Deployment, имеющий публичный IP/Ingress для доступа пользователей.
2. DBs, Message Brokers, S3.
   * "Кластер операционных БД" и "Кластер аналитических БД" могут быть:
     * Managed solutions (например, AWS RDS/Aurora, Google Cloud SQL, Azure Database).
     * Самостоятельно развернутые базы (PostgreSQL) в Kubernetes или VMs (по необходимости).
   * Kafka (Message Broker) развернут в кластере или как Managed Service (Confluent Cloud, AWS MSK и т. п.).
   * S3 (Object Storage) берется как Managed Service в AWS, GCP, Azure, либо MinIO в Kubernetes.
3. Clients и IDP.
   * Мобильное приложение и веб-сайт взаимодействуют через HTTPS, используя DNS-имя API Gateway.
   * Для аутентификации переадресуют пользователя на Identity Provider (внешний Auth-сервер).

## Безопасность
1. Аутентификация и Авторизация.
   * Пользователь проходит OAuth2 / OpenID Connect через IDP (Identity Provider).
   * API Gateway проверяет токен, может использовать JWT для общения между микросервисами.
   * Внутри Service Mesh - mTLS между сервисами, обеспечивающий проверку подлинности (service-to-service auth).
2. Шифрование.
   * HTTPS/TLS для всех внешних соединений (от клиента к API Gateway).
   * mTLS внутри кластера (Service Mesh обеспечивает шифрование трафика).
   * В операционных и аналитических БД можно включать шифрование на уровне диска (Transparent Data Encryption) или отдельных полей (column-level encryption).
3. Разделение данных.
   * Каждый сервис обладает доступом только к своей базе - минимально необходимые права.
   * Role-Based Access Control (RBAC) в Kubernetes для администрирования кластером.
4. Безопасность кода.
   * Автоматическая проверка уязвимостей в Docker-образах, статический анализ кода и периодический пен-тест.
5. Соответствие регуляторным требованиям.
   * Для персональных данных - учет GDPR, CCPA.
   * Для биометрических/данных о здоровье - HIPAA (если часть данных под нее подпадает).
   * Механизмы "Right to be forgotten", аудит доступа, хранение логов авторизаций.

## Навигация

1. [Бизнес-цели](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/business_objectives.md)
2. [Функциональные требования](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/functional_requirements.md)
3. [Стейкхолдеры](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/stakeholders.md)
4. [Концептуальная архитектура](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/concept_architecture.md)
5. [Риски реализации](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/implementation_risks.md)
6. [План поэтапной разработки и расширения системы, анализ критически важных компонентов](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/development_plan.md)
7. [Критические бизнес-сценарии](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/critical_business_scenarios.md)
8. [Атрибуты качества](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/quality_attributes.md)
9. [Нефункциональные требования](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/nonfunctional_requirements.md)
10. [Архитектурные опции](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/architectural_options.md)
11. Список ADR
    1. [Выбор микросервисной архитектуры](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/adr_01.md)
    2. [Использование контейнеризации (Docker/Kubernetes)](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/adr_02.md)
    3. [Хранение пользовательских данных](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/adr_03.md)
    4. [Выделение БД для аналитики](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/adr_04.md)
    5. [Аутентификация и авторизация (OAuth2 / OpenID Connect)](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/adr_05.md)
    6. [Наблюдаемость (Observability)](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/adr_06.md)
12. [Описание сценариев использования приложения](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/use_cases.md)
13. [Базовая архитектура](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/basic_architecture.md)
14. [Основные представления](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/views.md)
15. [Анализ рисков созданной архитектуры, компромиссов](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/architecture_risks.md)
16. [Стоимость владения системой](https://github.com/f0rw4rd-dev/sb-final-project/blob/main/costs.md)